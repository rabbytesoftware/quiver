version: "0.1" # ? Which Arrow version this template is compatible with

metadata:
  name: "Counter-Strike 2 SRCDS"
  description: "A basic Counter-Strike 2 Dedicated Server"
  mainteiners:
    - "https://char2cs.net"
  credits:
    - "Valve Corporation"
    - "The Quiver Project && Rabbyte Software"
  license: "MIT"
  repository: "https://github.com/rabbytesoftware/arrow.cs2"
  documentation: "https://github.com/rabbytesoftware/arrow.cs2"
  version: "0.0.1" # ? Arrow's own versioning

requirements:
  minimum:
    cpu_cores: 2
    ram_gb: 4
    disk_gb: 30
    network_mbps: 10
  recommended:
    cpu_cores: 4
    ram_gb: 8
    disk_gb: 50
    network_mbps: 20

dependencies:
  - "steamcmd" # ? This will be internally translated to: "https://raw.githubusercontent.com/rabbytesoftware/quiver.pkgs/25.05/steamcmd.yaml"

netbridge: 
  - name: "GAME_PORT"
    protocol: "tcp/udp"

variables:
  - name: "SERVER_HOSTNAME"
    default: "CS2 Server hosted with Quiver"
  - name: "DEFAULT_MAP"
    default: "de_dust2"
    values: ["de_dust2", "de_mirage", "de_inferno", "de_cache", "de_overpass", "de_nuke", "de_train", "de_vertigo", "de_ancient", "de_anubis"]
  - name: "MAX_PLAYERS"
    default: 12
    min: 2
    max: 64
  - name: "SERVER_PASSWORD"
    default: "7355608"
    sensitive: true
  - name: "RCON_PASSWORD"
    default: "7355608"
    sensitive: true

methods:
  install: 
    windows: 
      - "${steamcmd.execute} +login anonymous +force_install_dir ${INSTALL_PATH} +app_update 730 validate +quit"
    linux:
      - "${steamcmd.execute} +login anonymous +force_install_dir ${INSTALL_PATH} +app_update 730 validate +quit"
  execute:
    windows:
      - "${INSTALL_PATH}\\cs2.exe -dedicated -console -usercon +hostname ${SERVER_HOSTNAME} +map ${DEFAULT_MAP} +maxplayers ${MAX_PLAYERS} +sv_password ${SERVER_PASSWORD} -port ${GAME_PORT}"
    linux:
      - "${INSTALL_PATH}/cs2 -dedicated -console -usercon +hostname ${SERVER_HOSTNAME} +map ${DEFAULT_MAP} +maxplayers ${MAX_PLAYERS} +sv_password ${SERVER_PASSWORD} -port ${GAME_PORT}"
  uninstall:
    windows:
      - "${steamcmd.execute} +login anonymous +force_install_dir ${INSTALL_PATH} +app_uninstall 730 +quit"
    linux:
      - "${steamcmd.execute} +login anonymous +force_install_dir ${INSTALL_PATH} +app_uninstall 730 +quit"
  update:
    windows:
      - "${steamcmd.execute} +login anonymous +force_install_dir ${INSTALL_PATH} +app_update 730 validate +quit"
    linux:
      - "${steamcmd.execute} +login anonymous +force_install_dir ${INSTALL_PATH} +app_update 730 validate +quit"
  validate:
    windows:
      - "${steamcmd.execute} +login anonymous +force_install_dir ${INSTALL_PATH} +app_update 730 validate +quit"
    linux:
      - "${steamcmd.execute} +login anonymous +force_install_dir ${INSTALL_PATH} +app_update 730 validate +quit"
